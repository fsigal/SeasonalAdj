library(readxl)
library(writexl)
library(seasonal)
library(forecast)

# Septiembre 2024
const01 = read_xlsx("14- Construccion.xlsx",sheet = "Cemento_SF",col_names = FALSE,range = "B6:B254")
const01 = ts(const01$...1, frequency = 12, start = c(2004,1))
const02 = read_xlsx("14- Construccion.xlsx",sheet = "Cemento_Cba",col_names = FALSE,range = "B6:B254")
const02 = ts(const02$...1, frequency = 12, start = c(2004,1))
const03 = read_xlsx("14- Construccion.xlsx",sheet = "Cemento_ER",col_names = FALSE,range = "B6:B254")
const03 = ts(const03$...1, frequency = 12, start = c(2004,1))
const04 = read_xlsx("14- Construccion.xlsx",sheet = "Empleo SF",col_names = FALSE,range = "B4:B209")
const04 = ts(const04$...1, frequency = 12, start = c(2007,6))
const05 = read_xlsx("14- Construccion.xlsx",sheet = "Empleo ER",col_names = FALSE,range = "B4:B209")
const05 = ts(const05$...1, frequency = 12, start = c(2007,6))
const06 = read_xlsx("14- Construccion.xlsx",sheet = "Empleo C",col_names = FALSE,range = "B4:B209")
const06 = ts(const06$...1, frequency = 12, start = c(2007,6))
const07 = read_xlsx("14- Construccion.xlsx",sheet = "Empleo BA sin CABA",col_names = FALSE,range = "B4:B209")
const07 = ts(const07$...1, frequency = 12, start = c(2007,6))
const08 = read_xlsx("14- Construccion.xlsx",sheet = "Nacion",col_names = FALSE,range = "B4:B209")
const08 = ts(const08$...1, frequency = 12, start = c(2007,6))

model04 = auto.arima(const04)
forecast(model04,h=3)
model05 = auto.arima(const05)
forecast(model05,h=3)
model06 = auto.arima(const06)
forecast(model06,h=3)
model07 = auto.arima(const07)
forecast(model07,h=3)
model08 = auto.arima(const08)
forecast(model08,h=3)


const01d = seas(const01, x11="")
const02d = seas(const02, x11="")
const03d = seas(const03, x11="")
const04d = seas(const04, x11="")
const05d = seas(const05, x11="")
const06d = seas(const06, x11="")
const07d = seas(const07, x11="")
const08d = seas(const08, x11="")

const01_conc = cbind(const01d$series$d11,blanco,blanco,const01d$series$d12)
write_xlsx(as.data.frame(const01_conc),"const01_d11_d12.xlsx")
const02_conc = cbind(const02d$series$d11,blanco,blanco,const02d$series$d12)
write_xlsx(as.data.frame(const02_conc),"const02_d11_d12.xlsx")
const03_conc = cbind(const03d$series$d11,blanco,blanco,const03d$series$d12)
write_xlsx(as.data.frame(const03_conc),"const03_d11_d12.xlsx")
const04_conc = cbind(const04d$series$d11,blanco,blanco,const04d$series$d12)
write_xlsx(as.data.frame(const04_conc),"const04_d11_d12.xlsx")
const05_conc = cbind(const05d$series$d11,blanco,blanco,const05d$series$d12)
write_xlsx(as.data.frame(const05_conc),"const05_d11_d12.xlsx")
const06_conc = cbind(const06d$series$d11,blanco,blanco,const06d$series$d12)
write_xlsx(as.data.frame(const06_conc),"const06_d11_d12.xlsx")
const07_conc = cbind(const07d$series$d11,blanco,blanco,const07d$series$d12)
write_xlsx(as.data.frame(const07_conc),"const07_d11_d12.xlsx")
const08_conc = cbind(const08d$series$d11,blanco,blanco,const08d$series$d12)
write_xlsx(as.data.frame(const08_conc),"const08_d11_d12.xlsx")
