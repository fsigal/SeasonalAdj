library(readxl)
library(writexl)
library(seasonal)
library(forecast)


blanco = 0

# Septiembre 2024
merca01 = read_xlsx("11- Mercado laboral.xlsx",sheet = "EIL GP Mens",col_names = FALSE,range = "B5:B232")
merca01 = ts(merca01$...1, frequency = 12, start = c(2005,10))
merca02 = read_xlsx("11- Mercado laboral.xlsx",sheet = "EIL GR Mens",col_names = FALSE,range = "B5:B308")
merca02 = ts(merca02$...1, frequency = 12, start = c(1999,6))
merca03 = read_xlsx("11- Mercado laboral.xlsx",sheet = "EIL GC Mens",col_names = FALSE,range = "B5:B308")
merca03 = ts(merca03$...1, frequency = 12, start = c(1999,6))
merca04 = read_xlsx("11- Mercado laboral.xlsx",sheet = "SIPA C",col_names = FALSE,range = "B5:B193")
merca04 = ts(merca04$...1, frequency = 12, start = c(2009,1))
merca05 = read_xlsx("11- Mercado laboral.xlsx",sheet = "SIPA ER",col_names = FALSE,range = "B5:B193")
merca05 = ts(merca05$...1, frequency = 12, start = c(2009,1))
merca06 = read_xlsx("11- Mercado laboral.xlsx",sheet = "SIPA SF",col_names = FALSE,range = "B5:B193")
merca06 = ts(merca06$...1, frequency = 12, start = c(2009,1))
merca07 = read_xlsx("11- Mercado laboral.xlsx",sheet = "SIPA - Total Naci√≥n",col_names = FALSE,range = "B3:B189")
merca07 = ts(merca07$...1, frequency = 12, start = c(2009,1))
merca08 = read_xlsx("11- Mercado laboral.xlsx",sheet = "Salarios Nacion",col_names = FALSE,range = "B5:B176")
merca08 = ts(merca08$...1, frequency = 12, start = c(2009,1))
merca09 = read_xlsx("11- Mercado laboral.xlsx",sheet = "Salario SF",col_names = FALSE,range = "B5:B176")
merca09 = ts(merca09$...1, frequency = 12, start = c(2009,1))
merca10 = read_xlsx("11- Mercado laboral.xlsx",sheet = "Salarios C",col_names = FALSE,range = "B5:B176")
merca10 = ts(merca10$...1, frequency = 12, start = c(2009,1))
merca11 = read_xlsx("11- Mercado laboral.xlsx",sheet = "Salarios ER",col_names = FALSE,range = "B5:B176")
merca11 = ts(merca11$...1, frequency = 12, start = c(2009,1))


model04 = auto.arima(merca04)
forecast(model04,h=3)
model05 = auto.arima(merca05)
forecast(model05,h=3)
model06 = auto.arima(merca06)
forecast(model06,h=3)
model07 = auto.arima(merca07)
forecast(model07,h=3)
model08 = auto.arima(merca08)
forecast(model08,h=3)
model09 = auto.arima(merca09)
forecast(model09,h=3)
model10 = auto.arima(merca10)
forecast(model10,h=3)


merca01d = seas(merca01, x11="")
merca02d = seas(merca02, x11="")
merca03d = seas(merca03, x11="")
merca04d = seas(merca04, x11="")
merca05d = seas(merca05, x11="")
merca06d = seas(merca06, x11="")
merca08d = seas(merca08, x11="")
merca09d = seas(merca09, x11="")
merca10d = seas(merca10, x11="")
merca11d = seas(merca11, x11="")

merca01_conc = cbind(merca01d$series$d11,blanco,blanco,merca01d$series$d12)
write_xlsx(as.data.frame(merca01_conc),"merca01_d11_d12.xlsx")
merca02_conc = cbind(merca02d$series$d11,blanco,blanco,merca02d$series$d12)
write_xlsx(as.data.frame(merca02_conc),"merca02_d11_d12.xlsx")
merca03_conc = cbind(merca03d$series$d11,blanco,blanco,merca03d$series$d12)
write_xlsx(as.data.frame(merca03_conc),"merca03_d11_d12.xlsx")
merca04_conc = cbind(merca04d$series$d11,blanco,blanco,merca04d$series$d12)
write_xlsx(as.data.frame(merca04_conc),"merca04_d11_d12.xlsx")
merca05_conc = cbind(merca05d$series$d11,blanco,blanco,merca05d$series$d12)
write_xlsx(as.data.frame(merca05_conc),"merca05_d11_d12.xlsx")
merca06_conc = cbind(merca06d$series$d11,blanco,blanco,merca06d$series$d12)
write_xlsx(as.data.frame(merca06_conc),"merca06_d11_d12.xlsx")
merca08_conc = cbind(merca08d$series$d11,blanco,blanco,merca08d$series$d12)
write_xlsx(as.data.frame(merca08_conc),"merca08_d11_d12.xlsx")
merca09_conc = cbind(merca09d$series$d11,blanco,blanco,merca09d$series$d12)
write_xlsx(as.data.frame(merca09_conc),"merca09_d11_d12.xlsx")
merca10_conc = cbind(merca10d$series$d11,blanco,blanco,merca10d$series$d12)
write_xlsx(as.data.frame(merca10_conc),"merca10_d11_d12.xlsx")
merca11_conc = cbind(merca11d$series$d11,blanco,blanco,merca11d$series$d12)
write_xlsx(as.data.frame(merca11_conc),"merca11_d11_d12.xlsx")