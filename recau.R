library(readxl)
library(writexl)
library(seasonal)
library(forecast)

#Septiembre 2024
recau01 = read_xlsx("12- Recaudacion Provincial Córdoba.xlsx",sheet = "IB IPC MIX",col_names = FALSE,range = "B4:B288")
recau01 = ts(recau01$...1, frequency = 12, start = c(2001,1))
recau02 = read_xlsx("12- Recaudacion Provincial Córdoba.xlsx",sheet = "AJ IPC MIX",col_names = FALSE,range = "B4:B288")
recau02 = ts(recau02$...1, frequency = 12, start = c(2001,1))
recau03 = read_xlsx("12- Recaudacion Provincial Córdoba.xlsx",sheet = "RT IPC MIX",col_names = FALSE,range = "B4:B288")
recau03 = ts(recau03$...1, frequency = 12, start = c(2001,1))
recau04 = read_xlsx("12- Recaudacion Provincial Entre Rios.xlsx",sheet = "AJ IPC MIX",col_names = FALSE,range = "B4:B240")
recau04 = ts(recau04$...1, frequency = 12, start = c(2005,1))
recau05 = read_xlsx("12- Recaudacion Provincial Entre Rios.xlsx",sheet = "IB IPC MIX",col_names = FALSE,range = "B4:B240")
recau05 = ts(recau05$...1, frequency = 12, start = c(2005,1))
recau06 = read_xlsx("12- Recaudacion Provincial Entre Rios.xlsx",sheet = "RT IPC MIX",col_names = FALSE,range = "B4:B240")
recau06 = ts(recau06$...1, frequency = 12, start = c(2005,1))
recau07 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "IB SF IPC MIX ",col_names = FALSE,range = "B4:B348")
recau07 = ts(recau07$...1, frequency = 12, start = c(1996,1))
recau08 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "AJ SF IPC MIX  ",col_names = FALSE,range = "B4:B348")
recau08 = ts(recau08$...1, frequency = 12, start = c(1996,1))
recau09 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "RT SF IPC MIX",col_names = FALSE,range = "B4:B348")
recau09 = ts(recau09$...1, frequency = 12, start = c(1996,1))
recau10 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "Inmobiliario SF IPC MIX",col_names = FALSE,range = "B4:B348")
recau10 = ts(recau10$...1, frequency = 12, start = c(1996,1))
recau11 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "Automotor SF IPC MIX",col_names = FALSE,range = "B4:B348")
recau11 = ts(recau11$...1, frequency = 12, start = c(1996,1))
recau12 = read_xlsx("12- Recaudacion provincial Santa Fe y RC.xlsx",sheet = "Varios SF IPC MIX",col_names = FALSE,range = "B4:B348")
recau12 = ts(recau12$...1, frequency = 12, start = c(1996,1))

model07 = auto.arima(recau07)
forecast(model07,h=3)
model08 = auto.arima(recau08)
forecast(model08,h=3)
model09 = auto.arima(recau09)
forecast(model09,h=3)
model10 = auto.arima(recau10)
forecast(model10,h=3)
model11 = auto.arima(recau11)
forecast(model11,h=3)
model12 = auto.arima(recau12)
forecast(model12,h=3)

recau01d = seas(recau01, x11="")
recau02d = seas(recau02, x11="")
recau03d = seas(recau03, x11="")
recau04d = seas(recau04, x11="")
recau05d = seas(recau05, x11="")
recau06d = seas(recau06, x11="")
recau07d = seas(recau07, x11="")
recau08d = seas(recau08, x11="")
recau09d = seas(recau09, x11="")
recau10d = seas(recau10, x11="")
recau11d = seas(recau11, x11="")
recau12d = seas(recau12, x11="")

recau01_conc = cbind(recau01d$series$d11,blanco,blanco,recau01d$series$d12)
write_xlsx(as.data.frame(recau01_conc),"recau01_d11_d12.xlsx")
recau02_conc = cbind(recau02d$series$d11,blanco,blanco,recau02d$series$d12)
write_xlsx(as.data.frame(recau02_conc),"recau02_d11_d12.xlsx")
recau03_conc = cbind(recau03d$series$d11,blanco,blanco,recau03d$series$d12)
write_xlsx(as.data.frame(recau03_conc),"recau03_d11_d12.xlsx")
recau04_conc = cbind(recau04d$series$d11,blanco,blanco,recau04d$series$d12)
write_xlsx(as.data.frame(recau04_conc),"recau04_d11_d12.xlsx")
recau05_conc = cbind(recau05d$series$d11,blanco,blanco,recau05d$series$d12)
write_xlsx(as.data.frame(recau05_conc),"recau05_d11_d12.xlsx")
recau06_conc = cbind(recau06d$series$d11,blanco,blanco,recau06d$series$d12)
write_xlsx(as.data.frame(recau06_conc),"recau06_d11_d12.xlsx")
recau07_conc = cbind(recau07d$series$d11,blanco,blanco,recau07d$series$d12)
write_xlsx(as.data.frame(recau07_conc),"recau07_d11_d12.xlsx")
recau08_conc = cbind(recau08d$series$d11,blanco,blanco,recau08d$series$d12)
write_xlsx(as.data.frame(recau08_conc),"recau08_d11_d12.xlsx")
recau09_conc = cbind(recau09d$series$d11,blanco,blanco,recau09d$series$d12)
write_xlsx(as.data.frame(recau09_conc),"recau09_d11_d12.xlsx")
recau10_conc = cbind(recau10d$series$d11,blanco,blanco,recau10d$series$d12)
write_xlsx(as.data.frame(recau10_conc),"recau10_d11_d12.xlsx")
recau11_conc = cbind(recau11d$series$d11,blanco,blanco,recau11d$series$d12)
write_xlsx(as.data.frame(recau11_conc),"recau11_d11_d12.xlsx")
recau12_conc = cbind(recau12d$series$d11,blanco,blanco,recau12d$series$d12)
write_xlsx(as.data.frame(recau12_conc),"recau12_d11_d12.xlsx")

