library(readxl)
library(writexl)
library(seasonal)
library(forecast)

# Septiembre 2024
gas01 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Res_C",col_names = FALSE,range = "B5:B385")
gas01 = ts(gas01$...1, frequency = 12, start = c(1993,1))
gas02 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Res_SF",col_names = FALSE,range = "B5:B385")
gas02 = ts(gas02$...1, frequency = 12, start = c(1993,1))
gas03 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Res_ER",col_names = FALSE,range = "B5:B301")
gas03 = ts(gas03$...1, frequency = 12, start = c(2000,1))
gas04 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Ind_C",col_names = FALSE,range = "B5:B385")
gas04 = ts(gas04$...1, frequency = 12, start = c(1993,1))
gas05 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Ind_SF",col_names = FALSE,range = "B5:B385")
gas05 = ts(gas05$...1, frequency = 12, start = c(1993,1))
gas06 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Ind_ER",col_names = FALSE,range = "B5:B301")
gas06 = ts(gas06$...1, frequency = 12, start = c(2000,1))
gas07 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Total_C",col_names = FALSE,range = "B3:B383")
gas07 = ts(gas07$...1, frequency = 12, start = c(1993,1))
gas08 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Total_ER",col_names = FALSE,range = "B3:B299")
gas08 = ts(gas08$...1, frequency = 12, start = c(2000,1))
gas09 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Total_SF",col_names = FALSE,range = "B3:B383")
gas09 = ts(gas09$...1, frequency = 12, start = c(1993,1))
gas10 = read_xlsx("10- Consumo de gas.xlsx",sheet = "TOTAL_ER_2",col_names = FALSE,range = "D2:D298")
gas10 = ts(gas10$...1, frequency = 12, start = c(2000,1))
gas11 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Total Servicios",col_names = FALSE,range = "B6:B378")
gas11 = ts(gas11$...1, frequency = 12, start = c(1993,1))
gas12 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Residencial",col_names = FALSE,range = "B5:B376")
gas12 = ts(gas12$...1, frequency = 12, start = c(1993,1))
gas13 = read_xlsx("10- Consumo de gas.xlsx",sheet = "Industria",col_names = FALSE,range = "B5:B376")
gas13 = ts(gas13$...1, frequency = 12, start = c(1993,1))



model03 = auto.arima(gas03)
forecast(model03,h=3)
model08 = auto.arima(gas08)
forecast(model08,h=3)
model09 = auto.arima(gas09)
forecast(model09,h=3)
model10 = auto.arima(gas10)
forecast(model10,h=3)

model01 = auto.arima(gas01)
forecast(model01,h=3)
model02 = auto.arima(gas02)
forecast(model02,h=3)
model03 = auto.arima(gas03)
forecast(model03,h=3)
model04 = auto.arima(gas04)
forecast(model04,h=3)
model05 = auto.arima(gas05)
forecast(model05,h=3)
model06 = auto.arima(gas06)
forecast(model06,h=3)

model11 = auto.arima(gas11)
forecast(model11,h=3)
model12 = auto.arima(gas12)
forecast(model12,h=3)
model13 = auto.arima(gas13)
forecast(model13,h=3)


gas01d = seas(gas01, x11="")
gas02d = seas(gas02, x11="")
gas03d = seas(gas03, x11="")
gas04d = seas(gas04, x11="")
gas05d = seas(gas05, x11="")
gas06d = seas(gas06, x11="")
gas07d = seas(gas07, x11="")
gas08d = seas(gas08, x11="")
gas09d = seas(gas09, x11="")
gas10d = seas(gas10, x11="")

gas01_conc = cbind(gas01d$series$d11,blanco,blanco,gas01d$series$d12)
write_xlsx(as.data.frame(gas01_conc),"gas01_d11_d12.xlsx")
gas02_conc = cbind(gas02d$series$d11,blanco,blanco,gas02d$series$d12)
write_xlsx(as.data.frame(gas02_conc),"gas02_d11_d12.xlsx")
gas03_conc = cbind(gas03d$series$d11,blanco,blanco,gas03d$series$d12)
write_xlsx(as.data.frame(gas03_conc),"gas03_d11_d12.xlsx")
gas04_conc = cbind(gas04d$series$d11,blanco,blanco,gas04d$series$d12)
write_xlsx(as.data.frame(gas04_conc),"gas04_d11_d12.xlsx")
gas05_conc = cbind(gas05d$series$d11,blanco,blanco,gas05d$series$d12)
write_xlsx(as.data.frame(gas05_conc),"gas05_d11_d12.xlsx")
gas06_conc = cbind(gas06d$series$d11,blanco,blanco,gas06d$series$d12)
write_xlsx(as.data.frame(gas06_conc),"gas06_d11_d12.xlsx")
gas07_conc = cbind(gas07d$series$d11,blanco,blanco,gas07d$series$d12)
write_xlsx(as.data.frame(gas07_conc),"gas07_d11_d12.xlsx")
gas08_conc = cbind(gas08d$series$d11,blanco,blanco,gas08d$series$d12)
write_xlsx(as.data.frame(gas08_conc),"gas08_d11_d12.xlsx")
gas09_conc = cbind(gas09d$series$d11,blanco,blanco,gas09d$series$d12)
write_xlsx(as.data.frame(gas09_conc),"gas09_d11_d12.xlsx")
gas10_conc = cbind(gas10d$series$d11,blanco,blanco,gas10d$series$d12)
write_xlsx(as.data.frame(gas10_conc),"gas10_d11_d12.xlsx")


write_xlsx(as.data.frame(gas01d$series$d11),"gas01_d11.xlsx")
write_xlsx(as.data.frame(gas01d$series$d12),"gas01_d12.xlsx")

write_xlsx(as.data.frame(gas02d$series$d11),"gas02_d11.xlsx")
write_xlsx(as.data.frame(gas02d$series$d12),"gas02_d12.xlsx")

write_xlsx(as.data.frame(gas03d$series$d11),"gas03_d11.xlsx")
write_xlsx(as.data.frame(gas03d$series$d12),"gas03_d12.xlsx")

write_xlsx(as.data.frame(gas04d$series$d11),"gas04_d11.xlsx")
write_xlsx(as.data.frame(gas04d$series$d12),"gas04_d12.xlsx")

write_xlsx(as.data.frame(gas05d$series$d11),"gas05_d11.xlsx")
write_xlsx(as.data.frame(gas05d$series$d12),"gas05_d12.xlsx")

write_xlsx(as.data.frame(gas06d$series$d11),"gas06_d11.xlsx")
write_xlsx(as.data.frame(gas06d$series$d12),"gas06_d12.xlsx")

write_xlsx(as.data.frame(gas07d$series$d11),"gas07_d11.xlsx")
write_xlsx(as.data.frame(gas07d$series$d12),"gas07_d12.xlsx")

write_xlsx(as.data.frame(gas08d$series$d11),"gas08_d11.xlsx")
write_xlsx(as.data.frame(gas08d$series$d12),"gas08_d12.xlsx")

write_xlsx(as.data.frame(gas09d$series$d11),"gas09_d11.xlsx")
write_xlsx(as.data.frame(gas09d$series$d12),"gas09_d12.xlsx")

write_xlsx(as.data.frame(gas10d$series$d11),"gas10_d11.xlsx")
write_xlsx(as.data.frame(gas10d$series$d12),"gas10_d12.xlsx")