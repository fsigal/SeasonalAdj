library(readxl)
library(writexl)
library(seasonal)
library(forecast)

# Septiembre 2024
aves01 = read_xlsx("23-Aves.xlsx",sheet = "SF",col_names = FALSE,range = "B6:B206")
aves01 = ts(aves01$...1, frequency = 12, start = c(2008,1))
aves02 = read_xlsx("23-Aves.xlsx",sheet = "C",col_names = FALSE,range = "B6:B206")
aves02 = ts(aves02$...1, frequency = 12, start = c(2008,1))
aves03 = read_xlsx("23-Aves.xlsx",sheet = "ER",col_names = FALSE,range = "B6:B206")
aves03 = ts(aves03$...1, frequency = 12, start = c(2008,1))
aves04 = read_xlsx("23-Aves.xlsx",sheet = "Precio Pollo",col_names = FALSE,range = "B4:B120")
aves04 = ts(aves04$...1, frequency = 12, start = c(2015,1))
aves05 = read_xlsx("23-Aves.xlsx",sheet = "Precio deflactado Pollo",col_names = FALSE,range = "B4:B120")
aves05 = ts(aves05$...1, frequency = 12, start = c(2015,1))

model04 = auto.arima(aves04)
forecast(model04,h=3)
model05 = auto.arima(aves05)
forecast(model05,h=3)

aves01d = seas(aves01, x11="")
aves02d = seas(aves02, x11="")
aves03d = seas(aves03, x11="")
aves04d = seas(aves04, x11="")
aves05d = seas(aves05, x11="")

aves01_conc = cbind(aves01d$series$d11,blanco,blanco,aves01d$series$d12)
write_xlsx(as.data.frame(aves01_conc),"aves01_d11_d12.xlsx")
aves02_conc = cbind(aves02d$series$d11,blanco,blanco,aves02d$series$d12)
write_xlsx(as.data.frame(aves02_conc),"aves02_d11_d12.xlsx")
aves03_conc = cbind(aves03d$series$d11,blanco,blanco,aves03d$series$d12)
write_xlsx(as.data.frame(aves03_conc),"aves03_d11_d12.xlsx")
aves04_conc = cbind(aves04d$series$d11,blanco,blanco,aves04d$series$d12)
write_xlsx(as.data.frame(aves04_conc),"aves04_d11_d12.xlsx")
aves05_conc = cbind(aves05d$series$d11,blanco,blanco,aves05d$series$d12)
write_xlsx(as.data.frame(aves05_conc),"aves05_d11_d12.xlsx")

